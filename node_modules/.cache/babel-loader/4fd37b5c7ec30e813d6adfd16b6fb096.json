{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\LudusApp\\\\src\\\\views\\\\Farms\\\\components\\\\FarmCards.tsx\";\nimport BigNumber from 'bignumber.js';\nimport React, { useEffect, useState } from 'react';\nimport Countdown from 'react-countdown';\nimport styled from 'styled-components';\nimport { useWallet } from 'use-wallet';\nimport Button from '../../../components/Button';\nimport Card from '../../../components/Card';\nimport CardContent from '../../../components/CardContent';\nimport CardIcon from '../../../components/CardIcon';\nimport Spacer from '../../../components/Spacer';\nimport useAllStakedValue from '../../../hooks/useAllStakedValue';\nimport useFarms from '../../../hooks/useFarms';\nimport useVBTC from '../../../hooks/useVBTC';\nimport { getEarned, getMasterChefContract } from '../../../vbtc/utils';\nimport { bnToDec } from '../../../utils';\nimport StrudelImg from '../../../assets/img/Strudel-logo-Icon.png';\nimport BTCImg from '../../../assets/img/Strudel-Bitcoin-Icon.png';\n\nconst FarmCards = () => {\n  const [farms] = useFarms();\n  const {\n    account\n  } = useWallet();\n  const stakedValue = useAllStakedValue();\n  const strudelIndex = farms.findIndex(({\n    tokenSymbol\n  }) => tokenSymbol === 'STRDL');\n  const strudelPrice = strudelIndex >= 0 && stakedValue[strudelIndex] ? stakedValue[strudelIndex].tokenPriceInWeth : new BigNumber(0); //console.log(strudelPrice.toString())\n\n  const BLOCKS_PER_YEAR = new BigNumber(2336000);\n  const STRUDEL_PER_BLOCK = new BigNumber(1);\n  const rows = farms.reduce((farmRows, farm, i) => {\n    const farmWithStakedValue = { ...farm,\n      ...stakedValue[i],\n      apy: stakedValue[i] ? strudelPrice.times(STRUDEL_PER_BLOCK).times(BLOCKS_PER_YEAR).times(stakedValue[i].poolWeight).times(stakedValue[i].multiplier).div(stakedValue[i].totalWethValue) : null,\n      percentage: stakedValue[i] ? Number(Number(stakedValue[i].poolWeight) * Number(100)).toFixed(2).toString() : null\n    };\n    const newFarmRows = [...farmRows];\n\n    if (i <= 1) {\n      newFarmRows[0].push(farmWithStakedValue);\n    } else {\n      newFarmRows[1].push(farmWithStakedValue);\n    }\n\n    return newFarmRows;\n  }, [[], []]);\n  return /*#__PURE__*/React.createElement(StyledCards, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, rows.map((farmRow, i) => /*#__PURE__*/React.createElement(StyledRow, {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, farmRow.map((farm, j) => /*#__PURE__*/React.createElement(React.Fragment, {\n    key: j,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FarmCard, {\n    farm: farm,\n    index: i + j,\n    rowIndex: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nconst FarmCard = ({\n  farm,\n  index,\n  rowIndex\n}) => {\n  const [startTime, setStartTime] = useState(0);\n  const [harvestable, setHarvestable] = useState(0);\n  const {\n    account\n  } = useWallet();\n  const {\n    lpTokenAddress\n  } = farm;\n  const vbtc = useVBTC();\n\n  const renderer = countdownProps => {\n    const {\n      hours,\n      minutes,\n      seconds\n    } = countdownProps;\n    const paddedSeconds = seconds < 10 ? `0${seconds}` : seconds;\n    const paddedMinutes = minutes < 10 ? `0${minutes}` : minutes;\n    const paddedHours = hours < 10 ? `0${hours}` : hours;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        width: '100%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 7\n      }\n    }, paddedHours, \":\", paddedMinutes, \":\", paddedSeconds);\n  };\n\n  useEffect(() => {\n    async function fetchEarned() {\n      if (vbtc) return;\n      const earned = await getEarned(getMasterChefContract(vbtc), lpTokenAddress, account);\n      setHarvestable(bnToDec(earned));\n    }\n\n    if (vbtc && account) {\n      fetchEarned();\n    }\n  }, [vbtc, lpTokenAddress, account, setHarvestable]);\n\n  const getSymbol = icon => {\n    switch (icon) {\n      case '1':\n        return StrudelImg;\n\n      case '2':\n        return BTCImg;\n\n      case '3':\n        return BTCImg;\n\n      default:\n        return icon;\n    }\n  };\n\n  const poolActive = true; // startTime * 1000 - Date.now() <= 0\n\n  return /*#__PURE__*/React.createElement(StyledCardWrapper, {\n    style: {\n      opacity: rowIndex === 1 && '0.5'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }\n  }, farm.pid == 1 && /*#__PURE__*/React.createElement(StyledCardAccent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(StyledContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CardIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      height: 48\n    },\n    src: getSymbol(farm.icon),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(StyledTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, farm.name), /*#__PURE__*/React.createElement(StyledDetails, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(StyledDetail, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, \"Deposit\", ' ', /*#__PURE__*/React.createElement(\"a\", {\n    href: farm.url,\n    target: \"_blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 17\n    }\n  }, farm.lpToken.toUpperCase())), /*#__PURE__*/React.createElement(StyledDetail, {\n    style: {\n      paddingTop: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontWeight: 700,\n      fontSize: '24px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 17\n    }\n  }, farm.percentage, \"%\"), ' ', /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 17\n    }\n  }), \"of \", farm.earnToken.toUpperCase(), \" rewards\")), /*#__PURE__*/React.createElement(Spacer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    disabled: !poolActive,\n    text: poolActive ? 'Select' : undefined,\n    to: `/farms/${farm.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  }, !poolActive && /*#__PURE__*/React.createElement(Countdown, {\n    date: new Date(startTime * 1000),\n    renderer: renderer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(StyledInsight, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 15\n    }\n  }, \"APY\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, farm.apy ? `${farm.apy.times(new BigNumber(100)).toNumber().toLocaleString('en-US').slice(0, -1)}%` : 'Loading ...'))))));\n};\n\nconst StyledCardAccent = styled.div`\n  background-size: 300% 300%;\n  border-radius: 12px;\n  position: absolute;\n  top: -2px;\n  right: -2px;\n  bottom: -2px;\n  left: -2px;\n  z-index: -1;\n`;\nconst StyledCards = styled.div`\n  width: 1240px;\n  @media (max-width: 1240px) {\n    width: 100%;\n  }\n`;\nconst StyledLoadingWrapper = styled.div`\n  align-items: center;\n  display: flex;\n  flex: 1;\n  justify-content: center;\n`;\nconst StyledRow = styled.div`\n  display: flex;\n  margin-bottom: ${props => props.theme.spacing[4]}px;\n  flex-flow: row wrap;\n  align-items: center;\n  justify-content: center;\n  @media (max-width: 768px) {\n    width: 100%;\n    flex-flow: column nowrap;\n    align-items: center;\n  }\n`;\nconst StyledCardWrapper = styled.div`\n  margin: 12px;\n  width: calc((900px - ${props => props.theme.spacing[4]}px * 2) / 3);\n  position: relative;\n`;\nconst StyledTitle = styled.h4`\n  color: ${props => props.theme.color.grey[600]};\n  font-size: 24px;\n  font-weight: 700;\n  margin: ${props => props.theme.spacing[2]}px 0 0;\n  padding: 0;\n`;\nconst StyledContent = styled.div`\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  background-size: 100%;\n`;\nconst StyledSpacer = styled.div`\n  height: ${props => props.theme.spacing[4]}px;\n  width: ${props => props.theme.spacing[4]}px;\n`;\nconst StyledDetails = styled.div`\n  margin-top: ${props => props.theme.spacing[2]}px;\n  text-align: center;\n`;\nconst StyledDetail = styled.div`\n  color: ${props => props.theme.color.grey[500]};\n`;\nconst StyledInsight = styled.div`\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n  border-radius: 8px;\n  background: #fffdfa;\n  color: #aa9584;\n  width: 100%;\n  margin-top: 12px;\n  line-height: 32px;\n  font-size: 13px;\n  border: 1px solid #e6dcd5;\n  text-align: center;\n  padding: 0 12px;\n`;\nconst StyledMoving = styled.div`\n  & > div {\n    height: 60px;\n  }\n`;\nexport default FarmCards;","map":{"version":3,"sources":["C:/xampp/htdocs/LudusApp/src/views/Farms/components/FarmCards.tsx"],"names":["BigNumber","React","useEffect","useState","Countdown","styled","useWallet","Button","Card","CardContent","CardIcon","Spacer","useAllStakedValue","useFarms","useVBTC","getEarned","getMasterChefContract","bnToDec","StrudelImg","BTCImg","FarmCards","farms","account","stakedValue","strudelIndex","findIndex","tokenSymbol","strudelPrice","tokenPriceInWeth","BLOCKS_PER_YEAR","STRUDEL_PER_BLOCK","rows","reduce","farmRows","farm","i","farmWithStakedValue","apy","times","poolWeight","multiplier","div","totalWethValue","percentage","Number","toFixed","toString","newFarmRows","push","map","farmRow","j","FarmCard","index","rowIndex","startTime","setStartTime","harvestable","setHarvestable","lpTokenAddress","vbtc","renderer","countdownProps","hours","minutes","seconds","paddedSeconds","paddedMinutes","paddedHours","width","fetchEarned","earned","getSymbol","icon","poolActive","opacity","pid","height","name","url","lpToken","toUpperCase","paddingTop","fontWeight","fontSize","earnToken","undefined","id","Date","toNumber","toLocaleString","slice","StyledCardAccent","StyledCards","StyledLoadingWrapper","StyledRow","props","theme","spacing","StyledCardWrapper","StyledTitle","h4","color","grey","StyledContent","StyledSpacer","StyledDetails","StyledDetail","StyledInsight","StyledMoving"],"mappings":"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","sourcesContent":["import BigNumber from 'bignumber.js'\r\nimport React, { useEffect, useState } from 'react'\r\nimport Countdown, { CountdownRenderProps } from 'react-countdown'\r\nimport styled from 'styled-components'\r\nimport { useWallet } from 'use-wallet'\r\nimport Button from '../../../components/Button'\r\nimport Card from '../../../components/Card'\r\nimport CardContent from '../../../components/CardContent'\r\nimport CardIcon from '../../../components/CardIcon'\r\nimport Loader from '../../../components/Loader'\r\nimport Spacer from '../../../components/Spacer'\r\nimport { Farm } from '../../../contexts/Farms'\r\nimport useAllStakedValue, {\r\n  StakedValue,\r\n} from '../../../hooks/useAllStakedValue'\r\nimport useFarms from '../../../hooks/useFarms'\r\nimport useVBTC from '../../../hooks/useVBTC'\r\nimport { getEarned, getMasterChefContract } from '../../../vbtc/utils'\r\nimport { bnToDec } from '../../../utils'\r\nimport { StrudelMoving, VBTCSpin } from '../../../components/Lottie'\r\nimport StrudelImg from '../../../assets/img/Strudel-logo-Icon.png'\r\nimport BTCImg from '../../../assets/img/Strudel-Bitcoin-Icon.png'\r\n\r\ninterface FarmWithStakedValue extends Farm, StakedValue {\r\n  isBalancer?: boolean\r\n  url?: string\r\n  apy: BigNumber\r\n  percentage: string\r\n}\r\n\r\nconst FarmCards: React.FC = () => {\r\n  const [farms] = useFarms()\r\n  const { account } = useWallet()\r\n  const stakedValue = useAllStakedValue()\r\n\r\n  const strudelIndex = farms.findIndex(\r\n    ({ tokenSymbol }) => tokenSymbol === 'STRDL',\r\n  )\r\n\r\n  const strudelPrice =\r\n    strudelIndex >= 0 && stakedValue[strudelIndex]\r\n      ? stakedValue[strudelIndex].tokenPriceInWeth\r\n      : new BigNumber(0)\r\n  //console.log(strudelPrice.toString())\r\n  const BLOCKS_PER_YEAR = new BigNumber(2336000)\r\n  const STRUDEL_PER_BLOCK = new BigNumber(1)\r\n\r\n  const rows = farms.reduce<FarmWithStakedValue[][]>(\r\n    (farmRows, farm, i) => {\r\n      const farmWithStakedValue = {\r\n        ...farm,\r\n        ...stakedValue[i],\r\n        apy: stakedValue[i]\r\n          ? strudelPrice\r\n            .times(STRUDEL_PER_BLOCK)\r\n            .times(BLOCKS_PER_YEAR)\r\n            .times(stakedValue[i].poolWeight)\r\n            .times(stakedValue[i].multiplier)\r\n            .div(stakedValue[i].totalWethValue)\r\n          : null,\r\n        percentage: stakedValue[i]\r\n          ? Number(Number(stakedValue[i].poolWeight) * Number(100))\r\n            .toFixed(2)\r\n            .toString()\r\n          : null,\r\n      }\r\n      const newFarmRows = [...farmRows]\r\n      if (i <= 1) {\r\n        newFarmRows[0].push(farmWithStakedValue)\r\n      } else {\r\n        newFarmRows[1].push(farmWithStakedValue)\r\n      }\r\n      return newFarmRows\r\n    },\r\n    [[], []],\r\n  )\r\n\r\n  return (\r\n    <StyledCards>\r\n      {rows.map((farmRow: any, i: any) => (\r\n        <StyledRow key={i}>\r\n          {farmRow.map((farm: any, j: any) => (\r\n            <React.Fragment key={j}>\r\n              <FarmCard farm={farm} index={i + j} rowIndex={i} />\r\n            </React.Fragment>\r\n          ))}\r\n        </StyledRow>\r\n      ))}\r\n    </StyledCards>\r\n  )\r\n}\r\n\r\ninterface FarmCardProps {\r\n  farm: FarmWithStakedValue\r\n  index: number\r\n  rowIndex: number\r\n}\r\n\r\nconst FarmCard: React.FC<FarmCardProps> = ({ farm, index, rowIndex }) => {\r\n  const [startTime, setStartTime] = useState(0)\r\n  const [harvestable, setHarvestable] = useState(0)\r\n\r\n  const { account } = useWallet()\r\n  const { lpTokenAddress } = farm\r\n  const vbtc = useVBTC()\r\n\r\n  const renderer = (countdownProps: CountdownRenderProps) => {\r\n    const { hours, minutes, seconds } = countdownProps\r\n    const paddedSeconds = seconds < 10 ? `0${seconds}` : seconds\r\n    const paddedMinutes = minutes < 10 ? `0${minutes}` : minutes\r\n    const paddedHours = hours < 10 ? `0${hours}` : hours\r\n    return (\r\n      <span style={{ width: '100%' }}>\r\n        {paddedHours}:{paddedMinutes}:{paddedSeconds}\r\n      </span>\r\n    )\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchEarned() {\r\n      if (vbtc) return\r\n      const earned = await getEarned(\r\n        getMasterChefContract(vbtc),\r\n        lpTokenAddress,\r\n        account,\r\n      )\r\n      setHarvestable(bnToDec(earned))\r\n    }\r\n    if (vbtc && account) {\r\n      fetchEarned()\r\n    }\r\n  }, [vbtc, lpTokenAddress, account, setHarvestable])\r\n\r\n  const getSymbol = (icon: string): any => {\r\n    switch (icon) {\r\n      case '1':\r\n        return StrudelImg\r\n      case '2':\r\n        return BTCImg\r\n      case '3':\r\n        return BTCImg\r\n      default:\r\n        return icon\r\n    }\r\n  }\r\n\r\n  const poolActive = true // startTime * 1000 - Date.now() <= 0\r\n\r\n  return (\r\n    <StyledCardWrapper style={{ opacity: rowIndex === 1 && '0.5' }}>\r\n      {farm.pid == 1 && <StyledCardAccent />}\r\n      <Card>\r\n        <CardContent>\r\n          <StyledContent>\r\n            <CardIcon>\r\n              <img style={{ height: 48 }} src={getSymbol(farm.icon)} />\r\n            </CardIcon>\r\n\r\n            <StyledTitle>{farm.name}</StyledTitle>\r\n            <StyledDetails>\r\n              <StyledDetail>\r\n                Deposit{' '}\r\n                <a href={farm.url} target=\"_blank\">\r\n                  {farm.lpToken.toUpperCase()}\r\n                </a>\r\n              </StyledDetail>\r\n              <StyledDetail style={{ paddingTop: '10px' }}>\r\n                <span style={{ fontWeight: 700, fontSize: '24px' }}>\r\n                  {farm.percentage}%\r\n                </span>{' '}\r\n                <br />\r\n                of {farm.earnToken.toUpperCase()} rewards\r\n              </StyledDetail>\r\n            </StyledDetails>\r\n            <Spacer />\r\n            <Button\r\n              disabled={!poolActive}\r\n              text={poolActive ? 'Select' : undefined}\r\n              to={`/farms/${farm.id}`}\r\n            >\r\n              {!poolActive && (\r\n                <Countdown\r\n                  date={new Date(startTime * 1000)}\r\n                  renderer={renderer}\r\n                />\r\n              )}\r\n            </Button>\r\n            <StyledInsight>\r\n              <span>APY</span>\r\n              <span>\r\n                {farm.apy\r\n                  ? `${farm.apy\r\n                    .times(new BigNumber(100))\r\n                    .toNumber()\r\n                    .toLocaleString('en-US')\r\n                    .slice(0, -1)}%`\r\n                  : 'Loading ...'}\r\n              </span>\r\n              {/* <span>\r\n                {farm.tokenAmount\r\n                  ? (farm.tokenAmount.toNumber() || 0).toLocaleString('en-US')\r\n                  : '-'}{' '}\r\n                {farm.tokenSymbol}\r\n              </span>\r\n              <span>\r\n                {farm.wethAmount\r\n                  ? (farm.wethAmount.toNumber() || 0).toLocaleString('en-US')\r\n                  : '-'}{' '}\r\n                ETH\r\n              </span> */}\r\n            </StyledInsight>\r\n          </StyledContent>\r\n        </CardContent>\r\n      </Card>\r\n    </StyledCardWrapper>\r\n  )\r\n}\r\n\r\nconst StyledCardAccent = styled.div`\r\n  background-size: 300% 300%;\r\n  border-radius: 12px;\r\n  position: absolute;\r\n  top: -2px;\r\n  right: -2px;\r\n  bottom: -2px;\r\n  left: -2px;\r\n  z-index: -1;\r\n`\r\n\r\nconst StyledCards = styled.div`\r\n  width: 1240px;\r\n  @media (max-width: 1240px) {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst StyledLoadingWrapper = styled.div`\r\n  align-items: center;\r\n  display: flex;\r\n  flex: 1;\r\n  justify-content: center;\r\n`\r\n\r\nconst StyledRow = styled.div`\r\n  display: flex;\r\n  margin-bottom: ${(props) => props.theme.spacing[4]}px;\r\n  flex-flow: row wrap;\r\n  align-items: center;\r\n  justify-content: center;\r\n  @media (max-width: 768px) {\r\n    width: 100%;\r\n    flex-flow: column nowrap;\r\n    align-items: center;\r\n  }\r\n`\r\n\r\nconst StyledCardWrapper = styled.div`\r\n  margin: 12px;\r\n  width: calc((900px - ${(props) => props.theme.spacing[4]}px * 2) / 3);\r\n  position: relative;\r\n`\r\n\r\nconst StyledTitle = styled.h4`\r\n  color: ${(props) => props.theme.color.grey[600]};\r\n  font-size: 24px;\r\n  font-weight: 700;\r\n  margin: ${(props) => props.theme.spacing[2]}px 0 0;\r\n  padding: 0;\r\n`\r\n\r\nconst StyledContent = styled.div`\r\n  align-items: center;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-size: 100%;\r\n`\r\n\r\nconst StyledSpacer = styled.div`\r\n  height: ${(props) => props.theme.spacing[4]}px;\r\n  width: ${(props) => props.theme.spacing[4]}px;\r\n`\r\n\r\nconst StyledDetails = styled.div`\r\n  margin-top: ${(props) => props.theme.spacing[2]}px;\r\n  text-align: center;\r\n`\r\n\r\nconst StyledDetail = styled.div`\r\n  color: ${(props) => props.theme.color.grey[500]};\r\n`\r\n\r\nconst StyledInsight = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  box-sizing: border-box;\r\n  border-radius: 8px;\r\n  background: #fffdfa;\r\n  color: #aa9584;\r\n  width: 100%;\r\n  margin-top: 12px;\r\n  line-height: 32px;\r\n  font-size: 13px;\r\n  border: 1px solid #e6dcd5;\r\n  text-align: center;\r\n  padding: 0 12px;\r\n`\r\nconst StyledMoving = styled.div`\r\n  & > div {\r\n    height: 60px;\r\n  }\r\n`\r\n\r\nexport default FarmCards\r\n"]},"metadata":{},"sourceType":"module"}